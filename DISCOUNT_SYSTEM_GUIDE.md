# üéØ –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∫–∏–¥–∫–∞–º–∏

–ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∫–∏–¥–∫–∞–º–∏ –∏ –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏ –¥–ª—è –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –Ω–µ–æ–Ω–æ–≤—ã—Ö –≤—ã–≤–µ—Å–æ–∫.

## üìã –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã

### üîß –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å (`/admin/discounts`)
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–∏–¥–æ–∫
- ‚úÖ –î–≤–∞ —Ç–∏–ø–∞ —Å–∫–∏–¥–æ–∫: –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –¥–∞—Ç–∞–º
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞
- ‚úÖ –õ–∏–º–∏—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
- ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ —Å–∫–∏–¥–∫–∏ (–¥–ª—è –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö)
- ‚úÖ –ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Å–∫–∏–¥–æ–∫
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π

### üõí –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–∫–∏–¥–æ–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
- ‚úÖ –í–≤–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ª—É—á—à–∏—Ö —Å–∫–∏–¥–æ–∫
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- ‚úÖ –†–∞—Å—á–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã —Å–æ —Å–∫–∏–¥–∫–æ–π

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL/Supabase)
```sql
discounts (
  id SERIAL PRIMARY KEY,
  name VARCHAR(255) NOT NULL,
  description TEXT,
  discount_type VARCHAR(20) CHECK (discount_type IN ('percentage', 'fixed_amount')),
  discount_value DECIMAL(10,2) NOT NULL,
  min_order_value DECIMAL(10,2),
  max_discount_amount DECIMAL(10,2),
  start_date DATE,
  end_date DATE,
  is_active BOOLEAN DEFAULT TRUE,
  usage_limit INTEGER,
  usage_count INTEGER DEFAULT 0,
  code VARCHAR(50) UNIQUE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
)
```

### –°–µ—Ä–≤–∏—Å—ã
- **`discountService.ts`** - –û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–∫–∏–¥–∫–∞–º–∏
- **`DiscountAdminPanel.tsx`** - –ê–¥–º–∏–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- **`DiscountDisplay.tsx`** - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–∫–∏–¥–æ–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π
- **`PromoCodeInput.tsx`** - –í–≤–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Å–∫—Ä–∏–ø—Ç:
```bash
psql -f create_discounts_table.sql
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ `.env` –µ—Å—Ç—å:
```env
VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
```

### 3. –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `/admin/discounts` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∫–∏–¥–∫–∞–º–∏.

## üìä –¢–∏–ø—ã —Å–∫–∏–¥–æ–∫

### 1. –ü—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ —Å–∫–∏–¥–∫–∏
```typescript
{
  discount_type: 'percentage',
  discount_value: 15, // 15%
  max_discount_amount: 100 // –ú–∞–∫—Å–∏–º—É–º ‚Ç¨100 —Å–∫–∏–¥–∫–∏
}
```

### 2. –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∫–∏–¥–∫–∏
```typescript
{
  discount_type: 'fixed_amount',
  discount_value: 50 // ‚Ç¨50 —Å–∫–∏–¥–∫–∏
}
```

## üéØ –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–∫–∏–¥–æ–∫

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫–∏–¥–∫–∏
- –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ —Ü–µ–Ω—ã
- –í—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–∫–∏–¥–∫–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤—ã–≥–æ–¥–æ–π
- –†–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ —Å–∫–∏–¥–∫–∏ –±–µ–∑ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤

### –ü—Ä–æ–º–æ–∫–æ–¥—ã
- –í–≤–æ–¥—è—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–æ–º –≤ –∫–æ—Ä–∑–∏–Ω–µ
- –ò–º–µ—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥
- –ú–æ–≥—É—Ç –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Å–∫–∏–¥–∫–∞–º–∏
- –í–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è –ø–æ –≤—Å–µ–º —É—Å–ª–æ–≤–∏—è–º

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
1. –ü—Ä–æ–º–æ–∫–æ–¥ (–µ—Å–ª–∏ –≤–≤–µ–¥–µ–Ω)
2. –õ—É—á—à–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∫–∏–¥–∫–∞
3. –ë–µ–∑ —Å–∫–∏–¥–∫–∏

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–∫–∏–¥–∫–∏
```typescript
import { discountService } from '../services/discountService';

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ª—É—á—à–µ–π —Å–∫–∏–¥–∫–∏
const application = await discountService.applyDiscount(orderTotal);

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
const application = await discountService.applyDiscount(orderTotal, 'SUMMER15');

if (application && application.isValid) {
  console.log('–°–∫–∏–¥–∫–∞:', application.discountAmount);
  console.log('–§–∏–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞:', application.finalPrice);
}
```

### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–∫–∏–¥–æ–∫
```tsx
import DiscountDisplay from '../components/DiscountDisplay';

<DiscountDisplay 
  orderTotal={1500}
  onDiscountSelect={(discount) => console.log('Selected:', discount)}
/>
```

### –í–≤–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞
```tsx
import PromoCodeInput from '../components/PromoCodeInput';

<PromoCodeInput
  orderTotal={1500}
  onDiscountApplied={(application) => {
    if (application) {
      setFinalPrice(application.finalPrice);
    }
  }}
/>
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### Row Level Security (RLS)
- –í–∫–ª—é—á–µ–Ω–∞ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `discounts`
- –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ –∞–∫—Ç–∏–≤–Ω—ã–º —Å–∫–∏–¥–∫–∞–º
- –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —É—Å–ª–æ–≤–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –∏ –¥–∞—Ç

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
```sql
-- –¢–æ–ø –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Å–∫–∏–¥–æ–∫
SELECT name, usage_count, usage_limit 
FROM discounts 
ORDER BY usage_count DESC;

-- –ê–∫—Ç–∏–≤–Ω—ã–µ —Å–∫–∏–¥–∫–∏
SELECT name, discount_value, discount_type, is_active
FROM discounts 
WHERE is_active = true;
```

### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
- –°—á–µ—Ç—á–∏–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π
- –°—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å—Ç–µ–∫—à–∏—Ö —Å–∫–∏–¥–æ–∫

## üé® –ü—Ä–∏–º–µ—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –°–∫–∏–¥–∫–∞ –Ω–æ–≤–æ–º—É –∫–ª–∏–µ–Ω—Ç—É
```sql
INSERT INTO discounts (name, description, discount_type, discount_value, min_order_value, code, is_active) 
VALUES ('–°–∫–∏–¥–∫–∞ –Ω–æ–≤–æ–º—É –∫–ª–∏–µ–Ω—Ç—É', '–°–∫–∏–¥–∫–∞ 10% –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤', 'percentage', 10.00, 100.00, 'WELCOME10', true);
```

### –°–µ–∑–æ–Ω–Ω–∞—è —Ä–∞—Å–ø—Ä–æ–¥–∞–∂–∞
```sql
INSERT INTO discounts (name, description, discount_type, discount_value, start_date, end_date, is_active) 
VALUES ('–õ–µ—Ç–Ω—è—è —Ä–∞—Å–ø—Ä–æ–¥–∞–∂–∞', '–°–∫–∏–¥–∫–∞ 20% –Ω–∞ –ª–µ—Ç–æ', 'percentage', 20.00, '2024-06-01', '2024-08-31', true);
```

### –°–∫–∏–¥–∫–∞ –Ω–∞ –±–æ–ª—å—à–æ–π –∑–∞–∫–∞–∑
```sql
INSERT INTO discounts (name, description, discount_type, discount_value, min_order_value, is_active) 
VALUES ('–ë–æ–ª—å—à–æ–π –∑–∞–∫–∞–∑', '–°–∫–∏–¥–∫–∞ ‚Ç¨100 –ø—Ä–∏ –∑–∞–∫–∞–∑–µ –æ—Ç ‚Ç¨1000', 'fixed_amount', 100.00, 1000.00, true);
```

## üîß –†–∞—Å—à–∏—Ä–µ–Ω–∏—è

### –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- [ ] –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Å–∫–∏–¥–∫–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
- [ ] –°–∫–∏–¥–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º —Ç–æ–≤–∞—Ä–æ–≤
- [ ] –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫–∏–¥–æ–∫
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å email –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–º

### –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è
–°–∏—Å—Ç–µ–º–∞ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –¥–ª—è:
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–∫–∏–¥–æ–∫
- –°–ª–æ–∂–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ —Å–∏—Å—Ç–µ–º–µ —Å–∫–∏–¥–æ–∫:
1. **–ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å:** `/admin/discounts`
2. **–õ–æ–≥–∏:** Browser DevTools ‚Üí Console
3. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** Supabase Dashboard ‚Üí Database ‚Üí discounts table
